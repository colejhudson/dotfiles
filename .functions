#!/usr/bin/env fish

function update-gf -a MESSAGE
  set URL https://whatthefuckisyourboyfrienddoing.now.sh/
  curl --request POST --data $MESSAGE $URL
end

function gcc-run -a program
  set file (mktemp)
  gcc $program -o $file
  and eval $file
  rm $file
end

function datascience_notebook
  set DOCKER_PORT 8080
  set DOCKER_ID (docker run -d -p $DOCKER_PORT:8888 -e JUPYTER_ENABLE_LAB=yes -w $PWD -v $PWD:$PWD jupyter/datascience-notebook jupyter-lab $argv)
  
  while not docker logs $DOCKER_ID 2>&1 | grep http | head -n 1 | cut -d '?' -f 2 | grep token
    sleep 0.1
  end

  set URL_PARAMETERS (docker logs $DOCKER_ID 2>&1 | grep http | head -n 1 | cut -d '?' -f 2)

  open "http://localhost:8080/?"$URL_PARAMETERS
end

function docker-most-recently-started
  docker ps | awk '{ print $1 }' | head -n 2 | tail -n 1
end

function docker-stop-most-recent
  docker stop (docker-most-recently-started)
end
